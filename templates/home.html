<script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–∫–æ–≤
    function trackClick(url) {
        fetch(`/track_click/${url}`)
            .then(response => response.json())
            .then(data => {
                console.log(data.message);
            })
            .catch(error => console.error('–û—à–∏–±–∫–∞:', error));
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ª–∞–π–∫–æ–≤
    function likeNews(url) {
        fetch(`/like_news/${url}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏, —á—Ç–æ–±—ã –æ—Ç—Ä–∞–∑–∏—Ç—å, —á—Ç–æ –ª–∞–π–∫ –±—ã–ª –ø–æ—Å—Ç–∞–≤–ª–µ–Ω
                    const likeButton = document.querySelector(`#like-button-${url}`);
                    likeButton.textContent = "üëç –õ–∞–π–∫ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω";
                    likeButton.style.backgroundColor = "#4CAF50"; // –ó–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ü–∏–∏
                    likeButton.style.color = "white"; // –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞
                    likeButton.disabled = true; // –û—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ª–∞–π–∫ –±—ã–ª –ø–æ—Å—Ç–∞–≤–ª–µ–Ω
                }
            })
            .catch(error => console.error('–û—à–∏–±–∫–∞:', error));
    }
</script>

{% extends 'base.html' %}
{% block content %}
<h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {% if current_user.is_authenticated %}{{ current_user.username }}{% else %}–ì–æ—Å—Ç—å{% endif %}</h2>
<p>–≠—Ç–æ –≤–∞—à–∞ –¥–æ–º–∞—à–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞.</p>

{% if tags %}
<h3>–í–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã:</h3>
<ul>
    {% for tag in tags %}
    <li>{{ tag }}</li>
    {% endfor %}
</ul>
{% else %}
<p>–£ –≤–∞—Å –Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤.</p>
{% endif %}

{% if news is not none and not news.empty %}
<h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏:</h3>
<ul>
    {% for index, article in news.iterrows() %}
    <li>
        <a href="{{ article['url'] }}" onclick="trackClick('{{ article['url'] }}');">{{ article['title'] }}</a>
        <form onsubmit="likeNews('{{ article['url'] }}'); return false;">
            <ul align="right">
                <button type="submit">üëç</button>
                <span id="likes-count-{{ article['url'] }}"></span>
            </ul>
        </form>
    </li>
    {% endfor %}
</ul>
{% else %}
<p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π.</p>
{% endif %}
{% endblock %}